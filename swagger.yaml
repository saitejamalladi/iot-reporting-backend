swagger: "2.0"

info:
  version: 1.0.0
  title: IOT Reporting APIs
  description: The IOT Reporting API document is intended strictly for internal use only.

schemes:
  - http
host: 34.126.111.208:8080
basePath: "/api"

securityDefinitions:
  Bearer:
    type: apiKey
    name: Authorization
    in: header

tags:
  - name: "auth"
    description: "Token generation"
  - name: "user"
    description: "Access to user information"
  - name: "device"
    description: "Access to device information"

paths:
  /auth/token:
    post:
      tags:
        - "auth"
      summary: To generate an auth token.
      description: This API generated the auth token based on client ID, client Secret, user id and app key shared.
      parameters:
        - in: "body"
          name: "body"
          description: "user object that needs to be shared to generate the token."
          required: true
          schema:
            $ref: "#/definitions/Auth"
      responses:
        200:
          description: The generated jwt token.
          schema:
            type: object
            properties:
              is_error:
                type: boolean
              status_code:
                type: integer
              display_msg:
                type: string
              res_data:
                type: object
                properties:
                  token:
                    type: string
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"

  /device/register:
    post:
      security:
        - Bearer: [ ]
      tags:
        - "device"
      summary: To register the device
      description: This API registers the device
      responses:
        200:
          description: The generated jwt token.
          schema:
            $ref: "#/definitions/PostRegisterDeviceResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"
  /device/list:
    get:
      security:
        - Bearer: [ ]
      tags:
        - "device"
      summary: To get the list of devices
      responses:
        200:
          description: Registered Devices list
          schema:
            $ref: "#/definitions/GetDeviceListResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"
  /user/create:
    post:
      security:
        - basicAuth: [ ]
      tags:
        - "user"
      summary: To create the user
      description: This API create the user
      parameters:
        - in: "body"
          name: "body"
          description: "user object that needs to be created"
          required: true
          schema:
            $ref: "#/definitions/CreateUser"
      responses:
        200:
          description: The generated jwt token.
          schema:
            $ref: "#/definitions/GenericResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"

  /user/info:
    get:
      security:
        - Bearer: [ ]
      tags:
        - "user"
      summary: To get the user info based on token accountId
      responses:
        200:
          description: User info
          schema:
            $ref: "#/definitions/GetUserInfoResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"
  /categories/create:
    post:
      security:
        - Bearer: []
      tags:
        - "categories"
      summary: To create a category
      description: Create a category
      parameters:
        - in: "body"
          name: "body"
          description: "Category that needs to be created"
          required: true
          schema:
            $ref: "#/definitions/CreateCategoryRequest"
      responses:
        200:
          description: Category created successfully
          schema:
            $ref: "#/definitions/CreateCategoryResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"
  /categories/list:
    get:
      tags:
        - "categories"
      summary: To list the categories
      responses:
        200:
          description: Category List
          schema:
            $ref: "#/definitions/ListCategoryResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"
  /categories/update:
    post:
      security:
        - Bearer: []
      tags:
        - "categories"
      summary: To update the existing category
      parameters:
        - in: "body"
          name: "body"
          required: true
          schema:
            $ref: "#/definitions/UpdateCategoryRequest"
      responses:
        200:
          description: Category updated successfully
          schema:
            $ref: "#/definitions/GenericResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"
  /categories/{id}:
    get:
      tags:
        - "categories"
      summary: To get a category based on id
      parameters:
        - in: "path"
          name: "id"
          description: "The category_id to be fetched"
          required: true
          type: integer
      responses:
        200:
          description: Category fetched
          schema:
            $ref: "#/definitions/GetCategoryResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"
    delete:
      security:
        - Bearer: []
      tags:
        - "categories"
      summary: To delete a category based on id
      parameters:
        - in: "path"
          name: "id"
          description: "The category_id to be fetched"
          required: true
          type: integer
      responses:
        200:
          description: Category removed
          schema:
            $ref: "#/definitions/GenericResponse"
        400:
          description: Something wrong in the body.
          schema:
            $ref: "#/definitions/GenericResponse"
        401:
          description: Invalid credentials
          schema:
            $ref: "#/definitions/GenericResponse"
definitions:
  GenericResponse:
    type: object
    properties:
      is_error:
        type: boolean
      status_code:
        type: integer
      display_msg:
        type: string
    xml:
      name: "GenericResponse"
  Auth:
    type: object
    required:
      - username
      - password
    properties:
      username:
        type: string
        example: ajdfhky12o83uwkjhfi
        description: user id of the user.
      password:
        type: string
        example: ajdfhky12o83uwkjhfi
        description:  password of the user.
    xml:
      name: "Auth"
  CreateUser:
    type: object
    required:
      - name
      - email
      - phone_number
      - country_code
      - timezone
      - password
      - confirm_password
    properties:
      name:
        type: string
        example: John Doe
      email:
        type: string
        example: john@jon.com
      phone_number:
        type: number
        example: 9876543210
      country_code:
        type: number
        example: 91
      timezone:
        type: string
        example: Asia/Kolkata
      password:
        type: string
        example: Dream@123123
      confirm_password:
        type: string
        example: Dream@123123
    xml:
      name: "CreateUser"
  PostRegisterDeviceResponse:
    type: object
    properties:
      is_error:
        type: boolean
      status_code:
        type: integer
      display_msg:
        type: string
      res_data:
        type: object
        properties:
          device_id:
            type: string
    xml:
      name: "PostRegisterDeviceResponse"
  GetDeviceListResponse:
    type: object
    properties:
      is_error:
        type: boolean
      status_code:
        type: integer
      display_msg:
        type: string
      res_data:
        type: object
        properties:
          device_id:
            type: integer
          account_id:
            type: integer
          created_at:
            type: string
          updated_at:
            type: string
    xml:
      name: "GetDeviceListResponse"
  GetUserInfoResponse:
    type: object
    properties:
      is_error:
        type: boolean
      status_code:
        type: integer
      display_msg:
        type: string
      res_data:
        type: object
        properties:
          accountId:
            type: integer
            example: 16
          companyId:
            type: integer
            example: 1
          username:
            type: string
            example: "bob"
          address:
            type: string
            example: "somewhere"
          address2:
            type: string
            example: "somehow"
          email:
            type: string
            example: "bob@test.com"
          firstName:
            type: string
            example: "bob"
          lastName:
            type: string
            example: "the builder"
    xml:
      name: "GetUserInfoResponse"
